# BuildTransaction

Prepares a transaction with paymaster sponsorship details. Takes the user's intended transaction calls and returns typed data that includes paymaster sponsorship, along with fee estimates and a tracking ID for monitoring.

## Method Signature

```go
func (pm *Paymaster) BuildTransaction(
    ctx context.Context,
    request *BuildTransactionRequest,
) (BuildTransactionResponse, error)
```

**Source:** [build_txn.go:L24-L45](https://github.com/NethermindEth/starknet.go/blob/main/paymaster/build_txn.go#L24-L45)

## Parameters

- `ctx` (context.Context): Context for the operation
- `request` (*BuildTransactionRequest): Transaction build request containing the transaction and execution parameters

## Returns

- `BuildTransactionResponse`: Response containing typed data, fee estimates, and tracking ID
- `error`: Error if build fails

## Type Definitions

### BuildTransactionResponse

**Source:** [build_txn.go:L382-L395](https://github.com/NethermindEth/starknet.go/blob/main/paymaster/build_txn.go#L382-L395)

```go
type BuildTransactionResponse struct {
    Type       UserTxnType            `json:"type"`
    Deployment *AccountDeploymentData `json:"deployment,omitempty"`
    Parameters *UserParameters        `json:"parameters"`
    TypedData  *typeddata.TypedData   `json:"typed_data,omitempty"`
    Fee        *FeeEstimate           `json:"fee"`
}
```

**Fields:**
- `Type` (UserTxnType): The type of the transaction
- `Deployment` (*AccountDeploymentData): Deployment data for deploy and deploy_and_invoke transactions (nil for invoke)
- `Parameters` (*UserParameters): Execution parameters to be used when executing the transaction
- `TypedData` (*typeddata.TypedData): Typed data for signing (nil for deploy transactions)
- `Fee` (*FeeEstimate): The fee estimation for the transaction

### FeeEstimate

**Source:** [build_txn.go:L371-L377](https://github.com/NethermindEth/starknet.go/blob/main/paymaster/build_txn.go#L371-L377)

```go
type FeeEstimate struct {
    GasTokenPriceInStrk       *felt.Felt `json:"gas_token_price_in_strk"`
    EstimatedFeeInStrk        *felt.Felt `json:"estimated_fee_in_strk"`
    EstimatedFeeInGasToken    *felt.Felt `json:"estimated_fee_in_gas_token"`
    SuggestedMaxFeeInStrk     *felt.Felt `json:"suggested_max_fee_in_strk"`
    SuggestedMaxFeeInGasToken *felt.Felt `json:"suggested_max_fee_in_gas_token"`
}
```

**Fields:**
- `GasTokenPriceInStrk` (*felt.Felt): Price of the gas token in STRK
- `EstimatedFeeInStrk` (*felt.Felt): Estimated transaction fee in STRK
- `EstimatedFeeInGasToken` (*felt.Felt): Estimated transaction fee in the gas token
- `SuggestedMaxFeeInStrk` (*felt.Felt): Suggested maximum fee in STRK to ensure execution
- `SuggestedMaxFeeInGasToken` (*felt.Felt): Suggested maximum fee in gas token to ensure execution

## Usage Example

- Build gasless transactions with paymaster sponsorship by including the returned typed data and fee estimates.
- Obtain fee calculations and estimates before executing transactions to display to users.
- Generate tracking IDs for monitoring transaction status through the paymaster service.
- Must be called before ExecuteTransaction to get the properly formatted typed data for signing.
- PaymasterData and tracking ID from the response are required for successful transaction execution.
